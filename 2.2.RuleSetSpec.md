# Specification for the RuleSet contents

## RuleSet
RuleSet is the biggest envelope that contains a set of stages and meta information.
### Meta
:warning: (Under construction)
> types are all json serializable type
- `ruleset_id` (integer | string?): A unique value that identifies the connection. RuleSets in the path share the same `ruleset_id`.
- `owner_address` (string): An identifier of the owner of the RuleSet. Typically, this value could be IP address or host name of the repeaters.
- `num_stages` (integer): The number of stages that are contained in a RuleSet.
- ?`checksum` (string?): A value to validate there is no unexpected changes in the RuleSet.

### Body
- `stages` (list\[Stage\]): A set of Stages that are executed one by one from top to bottom.


## Stage
*Stage* is a set of Rules and the only one Rule in a Stage can be executed at one time.

### Meta
:warning: (Under construction)
- `stage_id` (integer): An index of stage to tell which stage is now operated.
- Anything else?
### Body
- `rules` (list\[Rule\]): A set of Rules that are evaluated and only one Rule is executed at one time.


### Constraints
:warning: (Under construction)

If there are multiple Rules whose condition is satisfied, only the first Rule is executed.

## Rule
*Rule* is a unit of execution that contains a set of conditions and corresponding actions.

### Meta
:warning: (Under construction)
- `rule_id` (integer): An index to identify Rules.
- `name` (string): Human readable name of the Rule for debugging
- `send_tag` (integer): Identify which Rule receives the message this Rule send
- `receive_tag` (integer): A tag to identify the message to be assigned to this Rule

### Body
- `condition` (Condition): A set of condition clauses to be met
- `action` (Action): A set of action clauses to be performed

> Do we need to make this `Condition` instread of `list[ConditionClause]`?   
> Do we have meta info for condition and action?
## Condition
A condition that contains a set of condition clauses
### Meta
- `name` (string): A name of this condition for debugging
- ?`num_clauses` (integer): The number of conditions to be met

### Body
- `condition_clauses` (list \[ConditionClause\]): A set of condition clauses to be evaluated.

## Action
An action that contains a set of action clauses
### Meta
- `name` (string): A name of this action for debugging
- ?`num_clauses` (integer): The number of actions to be met

### Body
- `action_clauses` (list\[ActionClause\]): A set of action clauses to be evaluated

## ConditionClause

### Instruction Set
The following instructions are provided by Rule Engine or RuleSet Runtime as API functions to check the current status of the resources and devices.

:warning: (Under construction)
- `RES`
- `RECV`
## Action Clause

:warning: (Under construction)

### Instruction Set
These instructions are provided by Rule Engine or RuleSet Runtime as API functions to manipulate resources, send messages and so on.